HW3, Onyeka Isamah
================

``` r
library(tidyverse)
```

    ## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──

    ## ✓ ggplot2 3.3.5     ✓ purrr   0.3.4
    ## ✓ tibble  3.1.4     ✓ dplyr   1.0.7
    ## ✓ tidyr   1.1.3     ✓ stringr 1.4.0
    ## ✓ readr   2.0.1     ✓ forcats 0.5.1

    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## x dplyr::filter() masks stats::filter()
    ## x dplyr::lag()    masks stats::lag()

``` r
library(p8105.datasets)
```

# Problem 1:

The data set instacart has 1384617 rows and 15 columns which include
`order_id`, `product_id`, `add_to_cart_order`, `reordered user_id`,
`eval_set`, `order_number`, `order_dow`, `order_hour_of_day`,
`days_since_prior_order`, `product_name`, `aisle_id`, `department_id`,
`aisle`, and `departmemt`. There are 134 aisles, the three top aisles
that most products are order from include fresh fruits aisle (18726
bananas, ranked \#1 in fresh fruit category), the packaged vegetable
fruits aisle(Organic Baby Spiniach n = 9784 and ranked as \#1 product
within that aisle) and the milk aisle (organic whole milk n=4908).

``` r
data("instacart")
janitor::clean_names(instacart)
```

    ## # A tibble: 1,384,617 × 15
    ##    order_id product_id add_to_cart_order reordered user_id eval_set order_number
    ##       <int>      <int>             <int>     <int>   <int> <chr>           <int>
    ##  1        1      49302                 1         1  112108 train               4
    ##  2        1      11109                 2         1  112108 train               4
    ##  3        1      10246                 3         0  112108 train               4
    ##  4        1      49683                 4         0  112108 train               4
    ##  5        1      43633                 5         1  112108 train               4
    ##  6        1      13176                 6         0  112108 train               4
    ##  7        1      47209                 7         0  112108 train               4
    ##  8        1      22035                 8         1  112108 train               4
    ##  9       36      39612                 1         0   79431 train              23
    ## 10       36      19660                 2         1   79431 train              23
    ## # … with 1,384,607 more rows, and 8 more variables: order_dow <int>,
    ## #   order_hour_of_day <int>, days_since_prior_order <int>, product_name <chr>,
    ## #   aisle_id <int>, department_id <int>, aisle <chr>, department <chr>

``` r
max(instacart$aisle_id)
```

    ## [1] 134

``` r
top_products_by_aisle_df= instacart %>% select(
         everything()) %>% 
  group_by(aisle, department) %>% 
  count(
    product_name, name = "product_count") %>% 
  mutate(product_rank = min_rank(desc(product_count)))%>% 
 
   filter(product_rank <= 3)  %>% 
  arrange(product_rank) %>% arrange(desc(product_count)) 


top_products_by_aisle_df
```

    ## # A tibble: 406 × 5
    ## # Groups:   aisle, department [134]
    ##    aisle                      department product_name product_count product_rank
    ##    <chr>                      <chr>      <chr>                <int>        <int>
    ##  1 fresh fruits               produce    Banana               18726            1
    ##  2 fresh fruits               produce    Bag of Orga…         15480            2
    ##  3 fresh fruits               produce    Organic Str…         10894            3
    ##  4 packaged vegetables fruits produce    Organic Bab…          9784            1
    ##  5 packaged vegetables fruits produce    Organic Ras…          5546            2
    ##  6 packaged vegetables fruits produce    Organic Blu…          4966            3
    ##  7 milk                       dairy eggs Organic Who…          4908            1
    ##  8 fresh vegetables           produce    Organic Cuc…          4613            1
    ##  9 fresh vegetables           produce    Organic Zuc…          4589            2
    ## 10 fresh vegetables           produce    Organic Yel…          4290            3
    ## # … with 396 more rows

Plotting top products by aisle where product count &gt; 10000

``` r
top_products_by_aisle_df %>% 
filter(product_count >= 10000) %>% 
  ggplot(aes(x= product_name, y=product_count)) + geom_point(aes(color= aisle))
```

![](oi2142_HW3_files/figure-gfm/top%20products%20plot-1.png)<!-- -->

Table showing the three most popular items in each of the aisles “baking
ingredients”, “dog food care”, and “packaged vegetables fruits”.

``` r
pop3_df= (select(
  instacart, order_number, aisle,product_name) %>% 
  filter(aisle %in% c("baking ingredients", "dog food care", "packaged vegetables fruits")) %>% 
  
  group_by(aisle) %>% 
  count(
    product_name, name = "product_count") %>% 
    
  mutate(product_rank = min_rank(desc(product_count))) %>% 
    
   filter(product_rank <= 3)  %>% 
    
  arrange(product_rank) %>% arrange(desc(product_count)))

pop3_df
```

    ## # A tibble: 9 × 4
    ## # Groups:   aisle [3]
    ##   aisle                      product_name             product_count product_rank
    ##   <chr>                      <chr>                            <int>        <int>
    ## 1 packaged vegetables fruits Organic Baby Spinach              9784            1
    ## 2 packaged vegetables fruits Organic Raspberries               5546            2
    ## 3 packaged vegetables fruits Organic Blueberries               4966            3
    ## 4 baking ingredients         Light Brown Sugar                  499            1
    ## 5 baking ingredients         Pure Baking Soda                   387            2
    ## 6 baking ingredients         Cane Sugar                         336            3
    ## 7 dog food care              Snack Sticks Chicken & …            30            1
    ## 8 dog food care              Organix Chicken & Brown…            28            2
    ## 9 dog food care              Small Dog Biscuits                  26            3

Make a table showing the mean hour of the day at which Pink Lady Apples
and Coffee Ice Cream are ordered on each day of the week; format this
table for human readers (i.e. produce a 2 x 7 table).

``` r
mean_hod = instacart %>% drop_na() %>% 
  select(product_name,order_hour_of_day, order_dow)  %>% 
 mutate(
    
    order_dow = 
      recode_factor(order_dow,
        "0" = "Sunday", "1" = "Monday", "2" = "Tuesday", "3" = "Wednesday", "4"= "Thursday", "5" = "Friday", "6" = "Saturday")) %>% 
  group_by(product_name, order_dow) %>% 
  summarise(meanhour = mean(order_hour_of_day)) %>% 
filter(product_name %in% c( "Pink Lady Apples", "Coffee Ice Cream")) %>% 
  pivot_wider(names_from = order_dow,  values_from = meanhour) 
```

    ## `summarise()` has grouped output by 'product_name'. You can override using the `.groups` argument.

``` r
mean_hod
```

    ## # A tibble: 2 × 8
    ## # Groups:   product_name [2]
    ##   product_name     Sunday Monday Tuesday Wednesday Thursday Friday Saturday
    ##   <chr>             <dbl>  <dbl>   <dbl>     <dbl>    <dbl>  <dbl>    <dbl>
    ## 1 Coffee Ice Cream   13.8   14.3    15.4      15.3     15.2   12.3     13.8
    ## 2 Pink Lady Apples   13.4   11.4    11.7      14.2     11.6   12.8     11.9
